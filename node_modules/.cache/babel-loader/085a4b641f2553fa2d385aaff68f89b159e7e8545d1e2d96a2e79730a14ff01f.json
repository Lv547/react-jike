{"ast":null,"code":"import _regeneratorRuntime from\"D:/BaiduNetdiskDownload/React \\u57FA\\u7840 - \\u914D\\u5957\\u8D44\\u6599/React \\u57FA\\u7840 - \\u914D\\u5957\\u8D44\\u6599/React \\u57FA\\u7840 - day09/03-code/react-jike/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/BaiduNetdiskDownload/React \\u57FA\\u7840 - \\u914D\\u5957\\u8D44\\u6599/React \\u57FA\\u7840 - \\u914D\\u5957\\u8D44\\u6599/React \\u57FA\\u7840 - day09/03-code/react-jike/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";// 和用户相关的状态管理\nimport{createSlice}from'@reduxjs/toolkit';import{setToken as _setToken,getToken,removeToken}from'@/utils';import{loginAPI,getProfileAPI}from'@/apis/user';var userStore=createSlice({name:\"user\",// 数据状态\ninitialState:{token:getToken()||'',userInfo:{}},// 同步修改方法\nreducers:{setToken:function setToken(state,action){state.token=action.payload;_setToken(action.payload);},setUserInfo:function setUserInfo(state,action){state.userInfo=action.payload;},clearUserInfo:function clearUserInfo(state){state.token='';state.userInfo={};removeToken();}}});// 解构出actionCreater\nvar _userStore$actions=userStore.actions,setToken=_userStore$actions.setToken,setUserInfo=_userStore$actions.setUserInfo,clearUserInfo=_userStore$actions.clearUserInfo;// 获取reducer函数\nvar userReducer=userStore.reducer;// 登录获取token异步方法封装\nvar fetchLogin=function fetchLogin(loginForm){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return loginAPI(loginForm);case 2:res=_context.sent;dispatch(setToken(res.data.token));case 4:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};// 获取个人用户信息异步方法\nvar fetchUserInfo=function fetchUserInfo(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getProfileAPI();case 2:res=_context2.sent;dispatch(setUserInfo(res.data));case 4:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export{fetchLogin,fetchUserInfo,clearUserInfo};export default userReducer;","map":{"version":3,"names":["createSlice","setToken","_setToken","getToken","removeToken","loginAPI","getProfileAPI","userStore","name","initialState","token","userInfo","reducers","state","action","payload","setUserInfo","clearUserInfo","_userStore$actions","actions","userReducer","reducer","fetchLogin","loginForm","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","res","wrap","_callee$","_context","prev","next","sent","data","stop","_x","apply","arguments","fetchUserInfo","_ref2","_callee2","_callee2$","_context2","_x2"],"sources":["D:/BaiduNetdiskDownload/React 基础 - 配套资料/React 基础 - 配套资料/React 基础 - day09/03-code/react-jike/src/store/modules/user.js"],"sourcesContent":["// 和用户相关的状态管理\n\nimport { createSlice } from '@reduxjs/toolkit'\nimport { setToken as _setToken, getToken, removeToken } from '@/utils'\nimport { loginAPI, getProfileAPI } from '@/apis/user'\n\nconst userStore = createSlice({\n  name: \"user\",\n  // 数据状态\n  initialState: {\n    token: getToken() || '',\n    userInfo: {}\n  },\n  // 同步修改方法\n  reducers: {\n    setToken (state, action) {\n      state.token = action.payload\n      _setToken(action.payload)\n    },\n    setUserInfo (state, action) {\n      state.userInfo = action.payload\n    },\n    clearUserInfo (state) {\n      state.token = ''\n      state.userInfo = {}\n      removeToken()\n    }\n  }\n})\n\n\n// 解构出actionCreater\n\nconst { setToken, setUserInfo, clearUserInfo } = userStore.actions\n\n// 获取reducer函数\n\nconst userReducer = userStore.reducer\n\n// 登录获取token异步方法封装\nconst fetchLogin = (loginForm) => {\n  return async (dispatch) => {\n    const res = await loginAPI(loginForm)\n    dispatch(setToken(res.data.token))\n  }\n}\n\n// 获取个人用户信息异步方法\nconst fetchUserInfo = () => {\n  return async (dispatch) => {\n    const res = await getProfileAPI()\n    dispatch(setUserInfo(res.data))\n  }\n}\n\nexport { fetchLogin, fetchUserInfo, clearUserInfo }\n\nexport default userReducer"],"mappings":"8fAAA;AAEA,OAASA,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,QAAQ,GAAI,CAAAC,SAAS,CAAEC,QAAQ,CAAEC,WAAW,KAAQ,SAAS,CACtE,OAASC,QAAQ,CAAEC,aAAa,KAAQ,aAAa,CAErD,GAAM,CAAAC,SAAS,CAAGP,WAAW,CAAC,CAC5BQ,IAAI,CAAE,MAAM,CACZ;AACAC,YAAY,CAAE,CACZC,KAAK,CAAEP,QAAQ,CAAC,CAAC,EAAI,EAAE,CACvBQ,QAAQ,CAAE,CAAC,CACb,CAAC,CACD;AACAC,QAAQ,CAAE,CACRX,QAAQ,UAAAA,SAAEY,KAAK,CAAEC,MAAM,CAAE,CACvBD,KAAK,CAACH,KAAK,CAAGI,MAAM,CAACC,OAAO,CAC5Bb,SAAS,CAACY,MAAM,CAACC,OAAO,CAAC,CAC3B,CAAC,CACDC,WAAW,UAAAA,YAAEH,KAAK,CAAEC,MAAM,CAAE,CAC1BD,KAAK,CAACF,QAAQ,CAAGG,MAAM,CAACC,OAAO,CACjC,CAAC,CACDE,aAAa,UAAAA,cAAEJ,KAAK,CAAE,CACpBA,KAAK,CAACH,KAAK,CAAG,EAAE,CAChBG,KAAK,CAACF,QAAQ,CAAG,CAAC,CAAC,CACnBP,WAAW,CAAC,CAAC,CACf,CACF,CACF,CAAC,CAAC,CAGF;AAEA,IAAAc,kBAAA,CAAiDX,SAAS,CAACY,OAAO,CAA1DlB,QAAQ,CAAAiB,kBAAA,CAARjB,QAAQ,CAAEe,WAAW,CAAAE,kBAAA,CAAXF,WAAW,CAAEC,aAAa,CAAAC,kBAAA,CAAbD,aAAa,CAE5C;AAEA,GAAM,CAAAG,WAAW,CAAGb,SAAS,CAACc,OAAO,CAErC;AACA,GAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIC,SAAS,CAAK,CAChC,kCAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAO,SAAAC,QAAOC,QAAQ,MAAAC,GAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAE,IAAA,SACF,CAAA9B,QAAQ,CAACkB,SAAS,CAAC,QAA/BO,GAAG,CAAAG,QAAA,CAAAG,IAAA,CACTP,QAAQ,CAAC5B,QAAQ,CAAC6B,GAAG,CAACO,IAAI,CAAC3B,KAAK,CAAC,CAAC,yBAAAuB,QAAA,CAAAK,IAAA,MAAAV,OAAA,GACnC,mBAAAW,EAAA,SAAAf,IAAA,CAAAgB,KAAA,MAAAC,SAAA,QACH,CAAC,CAED;AACA,GAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAA,CAAS,CAC1B,kCAAAC,KAAA,CAAAlB,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAO,SAAAiB,SAAOf,QAAQ,MAAAC,GAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAc,UAAAC,SAAA,iBAAAA,SAAA,CAAAZ,IAAA,CAAAY,SAAA,CAAAX,IAAA,SAAAW,SAAA,CAAAX,IAAA,SACF,CAAA7B,aAAa,CAAC,CAAC,QAA3BwB,GAAG,CAAAgB,SAAA,CAAAV,IAAA,CACTP,QAAQ,CAACb,WAAW,CAACc,GAAG,CAACO,IAAI,CAAC,CAAC,yBAAAS,SAAA,CAAAR,IAAA,MAAAM,QAAA,GAChC,mBAAAG,GAAA,SAAAJ,KAAA,CAAAH,KAAA,MAAAC,SAAA,QACH,CAAC,CAED,OAASnB,UAAU,CAAEoB,aAAa,CAAEzB,aAAa,EAEjD,cAAe,CAAAG,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}